package 分割数组;

import java.util.Arrays;

class Solution {
    public int partitionDisjoint(int[] arr) {

        // 找到最小值,记录它的最右边的下标，同时记录左边的最大值
        int index = 0;
        
        int max = 0;
        for (int i = 0, min = arr[0]; i < arr.length; i++) {
            if (arr[i] <= min) {
                index = i;
                min = arr[i];
            }
        }
        for (int i = 0; i <= index; i++) {
            max = Math.max(max, arr[i]);
        }
        while(index < arr.length) {
            int j = index + 1;
            while (j < arr.length && max <= arr[j]) {
                j++;
            }

            if (j == arr.length) {
                if (arr[arr.length-1] == max) return arr.length - 1;
                return index + 1;
            }

            index = j;
            for (int i = 0; i <= index; i++) {
                max = Math.max(max, arr[i]);
            }
        }
        return arr.length;

    }

    public static void main(String[] args) {
        int[] arr = new int[]{24130,115564,140434,161773,151320,58519,75756,119643,78651,31582,174700,109574,78488,93417,174748,5711,1087,96999,102389,98354,17019,4213,169334,85164,126852,51316,58412,65104,122867,83873,101083,109005,68944,94714,136591,31820,90840,137652,10686,15803,41951,35687,81184,39797,164951,39512,6134,110700,93473,161451,17827,141853,21259,93859,83543,39455,164773,182205,13534,95633,164766,12227,126512,9950,109951,115926,176073,109637,92039,99979,123080,57240,87792,149448,121285,144830,118971,182456,114091,137853,128638,1652,17853,71246,46328,29943,108604,158359,126355,14231,136681,72058,50373,55014,13226,109182,81781,13960,161746,100828,121708,147625,167499,21896,169264,64798,26358,82993,178213,101071,32065,128686,176741,176367,104640,93861,59894,55912,103105,26413,41804,16996,159436,146063,137877,90750,161492,121656,158992,175183,83650,65725,3082,70780,111202,29321,108783,104772,131801,97361,4692,31702,59404,169072,85316,47707,21582,120021,129730,145875,98865,170105,166797,101542,164910,135592,137807,51918,35864,123693,5094,181600,160374,58099,50220,157109,14736,47199,53873,14927,176678,74946,54593,65797,177291,38059,172337,66296,47261,22403,15413,178683,84975,111028,149948,178143,616352,559781,791013,586562,269434,943086,219839,884599,387171,624670,839783,863743,738379,895091,684875,609859,797162,994616,339614,565092,353439,553557,288889,249280,633989,192619,466857,798980,628622,762420,634699,582335,514364,951114,298768,216474,824039,767554,397016,744200,468642,873636,603365,921193,743366,877540,926227,829303,818063,391883,765225,421827,941437,576676,328557,201975,814173,691796,896083,827962,723026,875209,515813,278167,394868,666842,281061,428722,981729,983424,595745,875787,998618,609144,400146,566507,589059,971154,274895,202739,483341,912860,208622,873840,541918,565248,397823,959827,283057,470333,966695,962282,782301,963160,985290,279860,696720,268648,861497,417990,601889,204757,420380,348352,671556,638269,201975,950718,736588,478524,759187,683112,505749,884397,755986,301115,771972,322447,471710,831052,319931,945655,999065,550264,382998,737371,916490,415668,204853,538417,444168,433894,929446,409119,317690,599016,551963,983220,282557,937400,254783,730240,425267,866543,649285,598791,627914,777445,958081,759068,226783,680037,554587,691819,953651,607188,239309,404698,704627,529816,422742,561998,695781,574736,426550,937274,930973,653702,971017,808065,894214,980738,872180,202023,738954,217267,944398,223500,572234,680612,616693,868762,760698,540222,678193,665475,464591,895108,745257,976157,880853,858907,575244,230596,744275,968204,344046,736324,259314,807492,755107,827499,937940,430109,464649,690168,901266,650450,300477,900674,835571,258220,992252,850004,702433,787978,684068,869476,808434,321328,778145,683454,412044,747604,604112,739844,420144,515716,244740,813333,929282,685428,910007,241035,208579,969380,753339,734292,485382,366830,763834,395899,614870,861538,955599,247086,488564,772067,517711,967931,436655,674054,327051,380608,966570,658638,886760,857150,488181,603314,295449,647719,731018,555370,209075,870520,272903,566736,851236,752375,457510,712091,208642,675984,537633,501895,264041,871968,252170,370713,701336,975268,242526,619130,642933,648990,862216,997657,931659,768302,880075,905490,671374,828690,190366,274175,564573,508188,220402,570608,560283,575967,194499,892930,841605,328308,863915,216144,987429,237639,999537,724268,764529,719721,479832,351556,467933,540628,349076,783711,653160,817706,567561,690023,227992,266347,898834,480274,315176,203978,785305,676793,939359,577788,308661,466383,294172,253222,391366,995328,626447,466201,932208,453546,658724,698863,840062,874738,710112,776354,971510,749856,338045,330303,288368,191115,686343,970511,977261,278579,279710,841527,814137,961901,313572,689786,837115,506412,247177,560921,301339,540385,600154,871429,215319,694414,736236,861998,893872,433361,397045,704750,196035,327493,254736,942347,338315,295358,579173,333909,468716,304643,736854,550732,871082,897972,473229,930426,991508,943689,913561,957483,517348,502748,252673,471185,311565,577173,914881,701750,273077,557374,417761,391425,448612,296536,645538,875455,596825,383844,218923,738063,671849,642938,894017,316028,593850,487489,548095,452379,296957,923739,702498,922203,916625,719984,415402,747991,989502,441707,522873,741746,669393,550705,389623,950520,782609,803722,339507,449327,601881,593738,939474,264887,211717,495857,928372,982593,953297,902351,358370,221001,199292,684088,847872,230446,461645,480473,446336,194644,429836,802268,521984,972114,965412,686878,725385,386404,466816,360625,666998,441766,752974,329374,431745,655926,752325,527013,916638,762403,430704,564537,335592,804984,542591,254442,948963,748759,674165,673317,675737,734960,343043,468408,260264,799008,572128,840486,770721,198579,900652,559289,369424,426826,612248,183752,989106,574706,323757,231362,905618,520719,998945,985485,921323,359335,686054,814186,799485,675574,883019,843330,285512,975551,387904,650224,954125,701497,780607,643075,384322,699592,365332,793907,901449,710795,313347,729990,836460,966483,551011,408985,641082,551625,202128,831404,359262,243711,648274,857341,573642,956783,606019,317590,824094,693614,675829,793011,923558,892792,197441,368991,535862,996537,779742,735948,245556,975339,713953,789187,727206,444065,455200,333267,894593,548538,896685,325192,500008,799743,573439,813475,237398,362115,317354,217978,625377,976533,768267,776917,306383,361224,940939,939191,283233,208229,357338,299526,226302,188880,964487,499923,452293,504529,440770,520624,995252,953096,488660,430513,735214,875951,830048,200907,732562,372564,700154,632081,288161,409516,397638,502121,921604,655802,184781,604368,257328,705215,352766,233060,190545,399855,458760,444761,556674,242498,584397,644259,351309,742904,586135,752672,398795,313711,881524,725303,666816,243331,196441,667466,783339,621629,366896,562023,590120,352386,294008,911845,210430,989969,187081,464029,258086,824679,417800,227845,691126,327500,463632,692093,961563,611608,540585,986198,190006,958343,901414,768576,844025,995780,320757,540078,347691,295387,287429,986505,311259,667788,605284,438465,980096,616639,993290,428536,203087,195471,842920,972167,196271,533575,850427,773242,673250,346470,316225,260995,666727,342582,508689,624592,562225,631603,886025,860961,256700,509305,875444,472999,247916,980302,551490,222229,607678,262955,923194,516736,770348,820808,605025,343564,925779,920060,579410,932150,611071,662200,273103,603638,702478,634337,829328,506715,251633,644589,363331,391379,675474,893633,836007,347354,745507,273083,322139,726619,888189,626831,375884,627617,299863,349223,302104,223097,347347,270307,639727,725528,214923,857723,249888,918890,875817,443220,721862,769489,256483,752320,319976,206411,803195,823430,258704,329341,904718,297978,489399,829860,196808,420723,373763,713246,978931,227123,384064,484456,710648,281007,381742,720145,468746,502278,184486,844815,742608,677235};
        Solution s = new Solution();
        int result = s.partitionDisjoint(arr);
        System.out.println(result);
    }
}